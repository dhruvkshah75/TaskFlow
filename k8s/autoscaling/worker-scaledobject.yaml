apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: worker-redis-scaler
  namespace: taskflow
spec:
  scaleTargetRef:
    name: worker               # Must match metadata.name in worker.yaml
  minReplicaCount: 2           # Keep 2 workers running (was 1)
  maxReplicaCount: 20          # Matches 'MAX_WORKERS' in your ConfigMap
  pollingInterval: 2           # Check Redis every 2 seconds (was 5)
  cooldownPeriod: 30           # Wait 30s after queue is empty to scale down
  
  triggers:
  - type: redis
    metadata:
      address: redis-low.taskflow.svc.cluster.local:6379  # Changed from redis-high
      listName: default 
      listLength: "5"
      databaseIndex: "0"
      enableTLS: "false"